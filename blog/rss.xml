<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/">
    <channel>
        <title>Mr.Hihi's Blog Blog</title>
        <link>https://mrhihi.github.io/blog</link>
        <description>Mr.Hihi's Blog Blog</description>
        <lastBuildDate>Wed, 07 Aug 2024 00:00:00 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>zh-Hant</language>
        <item>
            <title><![CDATA[macOS 如何在 Console 中使用剪貼簿的內容]]></title>
            <link>https://mrhihi.github.io/blog/clipboard-on-concole</link>
            <guid>https://mrhihi.github.io/blog/clipboard-on-concole</guid>
            <pubDate>Wed, 07 Aug 2024 00:00:00 GMT</pubDate>
            <description><![CDATA[工作中，時常會複製一堆文字資料到剪貼簿中，再貼到文字編輯器上做後製，如果這沱資料有表格結構到也好處理，偏偏有時候，它們就是一整沱：]]></description>
            <content:encoded><![CDATA[<p>工作中，時常會複製一堆文字資料到剪貼簿中，再貼到文字編輯器上做後製，如果這沱資料有表格結構到也好處理，偏偏有時候，它們就是一整沱：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">天空:藍色,白雲:飄動</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">海浪:翻滾,沙灘:溫暖</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">星星:閃爍,夜空:寧靜</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">風:輕拂,樹葉:搖曳</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">花:盛開,香氣:四溢</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">山:巍峨,雲霧:繚繞</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">河流:奔騰,清澈:見底</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">雨:滴落,傘下:細語</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">日出:曙光,晨曦:初現</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">城市:繁華,燈火:輝煌</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>備註</div><div class="admonitionContent_BuS1"><p>感謝 ChatGPT 友情贊助</p></div></div>
<p>如上逗號的前後都有一組 Key<!-- -->:Value<!-- --> 的資料，<br>
<!-- -->想要把他們做成四欄資料放到 excel 上面去，有很多方式可以處理，<br>
<!-- -->但我常常在想，如果可以複製進剪貼簿後，再貼出來，就變成我想要的樣子該有多好。</p>
<h1>搭配 Nushell 試試</h1>
<p>Nushell 可以用簡單的指令處理表格的資料，如果可以把剪貼簿的資料傳進 STDIO 讓 Nushell 處理，處理完後再複製回剪貼簿，感覺應該是個不錯的方式。
然後我找到了，在 macOS 下 pbpaste 跟 pbcopy 兩個好用的指令：</p>
<p>pbpaste: 把剪貼簿的內容貼到 STDIO<br>
<!-- -->pbcopy: 把 STDIO 輸出複製回剪貼簿</p>
<p>於是：</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pbpaste | lines | split column --regex "[:,]"</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" alt="split-column" src="https://mrhihi.github.io/assets/images/pic1-4a42c933a5ca156f3747d3ae81c5fec2.png" width="428" height="269" class="img_ev3q"></p>
<p>接著只要把 table 轉成 Tab 分隔，然後再複製回剪貼簿就大工告成</p>
<p>所以改一下語法</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pbpaste | lines | split column --regex "[:,]" | to csv -s "\t" | pbcopy</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="複製代碼至剪貼簿" title="複製" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>這個步驟因為是輸出到剪貼簿上，所以 Console 上不會有輸出<br>
<img decoding="async" loading="lazy" alt="data to excel" src="https://mrhihi.github.io/assets/images/pic2-1db1ddfc1da5a94edf29bd0745ef01b4.png" width="673" height="33" class="img_ev3q"></p>
<p>然後我們就可以快樂的貼到 Excel 上了：<br>
<img decoding="async" loading="lazy" alt="data to excel" src="https://mrhihi.github.io/assets/images/pic3-14d07d4eee28e94c39e40932f1dd0e47.png" width="446" height="262" class="img_ev3q"></p>
<h1>參考資料</h1>
<ul>
<li><a href="https://ss64.com/mac/pbpaste.html" target="_blank" rel="noopener noreferrer">https://ss64.com/mac/pbpaste.html</a></li>
<li><a href="https://ss64.com/mac/pbcopy.html" target="_blank" rel="noopener noreferrer">https://ss64.com/mac/pbcopy.html</a></li>
<li><a href="https://www.nushell.sh/commands/docs/to_csv.html" target="_blank" rel="noopener noreferrer">https://www.nushell.sh/commands/docs/to_csv.html</a></li>
<li><a href="https://www.nushell.sh/commands/docs/split_column.html" target="_blank" rel="noopener noreferrer">https://www.nushell.sh/commands/docs/split_column.html</a></li>
</ul>]]></content:encoded>
            <category>macOS</category>
            <category>nushell</category>
            <category>clipboard</category>
        </item>
    </channel>
</rss>